<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="resources/coqdoc.css" rel="stylesheet" type="text/css" />
<link href="resources/coqdocjs.css" rel="stylesheet" type="text/css"/>
<link href="custom/custom.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="custom/custom.js"></script>
<script type="text/javascript" src="resources/config.js"></script>
<script type="text/javascript" src="resources/coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a id="project-page" href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">oadt.tactics</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">oadt</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="oadt.base.html#"><span class="id" title="library">base</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab4"></a><h1 class="section">Fold over hypotheses</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">revert_all</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="var">revert</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
This cool trick to fold over hypotheses is inspired by
https://sympa.inria.fr/sympa/arc/coq-club/2014-12/msg00034.html 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">get_hyps</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">constr</span>:(<span class="id" title="keyword">ltac</span>:(<span class="id" title="var">revert_all</span>; <span class="id" title="tactic">constructor</span>) : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#::type_scope:'True'"><span class="id" title="notation">True</span></a>).<br/>

<br/>
</div>

<div class="doc">
Run <span class="inlinecode"><span class="id" title="var">tac</span></span> on each hypothesis. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "do_hyps" <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hs</span> := <span class="id" title="var">get_hyps</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> <span class="id" title="var">hs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">hs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">hs</span> ?<span class="id" title="var">H</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span>; <span class="id" title="var">go</span> <span class="id" title="var">hs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">go</span> <span class="id" title="var">hs</span>.<br/>

<br/>
</div>

<div class="doc">
Run <span class="inlinecode"><span class="id" title="var">tac</span></span> on each hypothesis matching <span class="inlinecode"><span class="id" title="var">pat</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "select" "!" <span class="id" title="var">open_constr</span>(<span class="id" title="var">pat</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">T</span> := <span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">pat</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">do_hyps</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">pat</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>);<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Clear&nbsp;the&nbsp;shelved.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">unify</span> <span class="id" title="var">T</span> <span class="id" title="var">pat</span>.<br/>

<br/>
</div>

<div class="doc">
Fold over hypotheses and return the <span class="inlinecode"><span class="id" title="keyword">constr</span></span> result. Run <span class="inlinecode"><span class="id" title="var">tac</span></span> on each
hypothesis with the accumulator. <span class="inlinecode"><span class="id" title="var">acc</span></span> is the initial accumulator. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">fold_hyps</span> <span class="id" title="var">acc</span> <span class="id" title="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hs</span> := <span class="id" title="var">get_hyps</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> <span class="id" title="var">hs</span> <span class="id" title="var">acc</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">hs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">hs</span> ?<span class="id" title="var">H</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">acc'</span> := <span class="id" title="var">tac</span> <span class="id" title="var">H</span> <span class="id" title="var">acc</span> <span class="id" title="tactic">in</span> <span class="id" title="var">go</span> <span class="id" title="var">hs</span> <span class="id" title="var">acc'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">go</span> <span class="id" title="var">hs</span> <span class="id" title="var">acc</span>.<br/>

<br/>
</div>

<div class="doc">
Fold over hypotheses with continuation. <span class="inlinecode"><span class="id" title="var">acc</span></span> and <span class="inlinecode"><span class="id" title="var">tac</span></span> are the same as in
<span class="inlinecode"><span class="id" title="var">fold_hyps_nok</span></span>. <span class="inlinecode"><span class="id" title="var">ktac</span></span> is the continuation run on the final result. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "fold_hyps_cont" <span class="id" title="keyword">constr</span>(<span class="id" title="var">acc</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">ktac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="var">fold_hyps</span> <span class="id" title="var">acc</span> <span class="id" title="var">tac</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">ktac</span> <span class="id" title="var">x</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab5"></a><h1 class="section">General purpose tactics</h1>

<div class="paragraph"> </div>

 Check <span class="inlinecode"><span class="id" title="var">a</span></span> contains <span class="inlinecode"><span class="id" title="var">pat</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "contains" <span class="id" title="keyword">constr</span>(<span class="id" title="var">a</span>) <span class="id" title="var">open_constr</span>(<span class="id" title="var">pat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">context</span> <span class="id" title="var">g</span> [<span class="id" title="var">pat</span>] =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">a'</span> := <span class="id" title="keyword">context</span> <span class="id" title="var">g</span> [<span class="id" title="var">pat</span>] <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unify</span> <span class="id" title="var">a</span> <span class="id" title="var">a'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check goal matches pattern <span class="inlinecode"><span class="id" title="var">pat</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "goal_is" <span class="id" title="var">open_constr</span>(<span class="id" title="var">pat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" title="var">pat</span> =&gt; <span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">T</span> =&gt; <span class="id" title="var">unify</span> <span class="id" title="var">T</span> <span class="id" title="var">pat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check goal contains <span class="inlinecode"><span class="id" title="var">pat</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "goal_contains" <span class="id" title="var">open_constr</span>(<span class="id" title="var">pat</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- ?<span class="id" title="var">T</span> =&gt; <span class="id" title="var">contains</span> <span class="id" title="var">T</span> <span class="id" title="var">pat</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">higher_order_reflexivity</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a>?<span class="id" title="var">f</span> ?<span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="tactic">eval</span> <span class="id" title="tactic">pattern</span> <span class="id" title="var">a</span> <span class="id" title="tactic">in</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">f'</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">unify</span> <span class="id" title="var">f</span> <span class="id" title="var">f'</span>; <span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Get the head of a type <span class="inlinecode"><span class="id" title="var">T</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">head</span> <span class="id" title="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">T</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| ?<span class="id" title="var">T</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">head</span> <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check if the head of a type <span class="inlinecode"><span class="id" title="var">T</span></span> is a constructor. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">head_constructor</span> <span class="id" title="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">C</span> := <span class="id" title="var">head</span> <span class="id" title="var">T</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">is_constructor</span> <span class="id" title="var">C</span>.<br/>

<br/>
</div>

<div class="doc">
A convoluted way to get the head of the conclusion of a type <span class="inlinecode"><span class="id" title="var">T</span></span>. If <span class="inlinecode"><span class="id" title="var">T</span></span>
is <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">a</span>,</span> <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><span class="id" title="var">b</span>,</span> <span class="inlinecode">...,</span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">z</span></span>, then <span class="inlinecode"><span class="id" title="var">concl_head</span></span> <span class="inlinecode"><span class="id" title="var">T</span></span> returns <span class="inlinecode"><span class="id" title="var">h</span></span>. 
</div>
<div class="code">
<span class="comment">(*&nbsp;TODO:&nbsp;is&nbsp;there&nbsp;a&nbsp;better&nbsp;approach?&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">concl_head_</span> <span class="id" title="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">eassert</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">T</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;[ <span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">T'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">H</span>; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">T</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">T</span> := <span class="id" title="var">head</span> <span class="id" title="var">T</span> <span class="id" title="tactic">in</span> <span class="id" title="var">unify</span> <span class="id" title="var">T'</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#::type_scope:'True'"><span class="id" title="notation">True</span></a>) <span class="id" title="var">T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="tactic">elim</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ?<span class="id" title="var">T</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">exact</span> <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> ].<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">concl_head</span> <span class="id" title="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">C</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="keyword">ltac</span>:(<span class="id" title="var">concl_head_</span> <span class="id" title="var">T</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">C</span> := <span class="id" title="tactic">eval</span> <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">C</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">C</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab6"></a><h2 class="section">Set solving</h2>

<div class="paragraph"> </div>

 Much faster set solving tactic, with less solving strength. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "fast_set_solver" :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">solve</span> [<span class="id" title="tactic">try</span> <span class="id" title="var">fast_done</span>; <span class="id" title="tactic">repeat</span> (<span class="id" title="var">set_unfold</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">intuition</span>)].<br/>

<br/>
</div>

<div class="doc">
Faster set solving tactic. Stronger than <span class="inlinecode"><span class="id" title="var">fast_set_solver</span></span>, but also
slower. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "fast_set_solver" "*" :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">fast_done</span>; <span class="id" title="var">set_unfold</span>; <span class="id" title="var">qauto</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">set_fold_not</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (?<span class="id" title="var">x</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> ?<span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#4291a6e02d5eff431051107aaf15194c"><span class="id" title="notation">∉</span></a> <span class="id" title="var">v</span>) <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> (?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> ?<span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">v</span>) <span class="id" title="tactic">in</span> *.<br/>

<br/>
</div>

<div class="doc">
Pruning the hypotheses before set solving can <i>dramatically</i> improve
performance. The following pruning tactics are based on heuristics, and they can
make the goal unprovable. While they are unsound, they still work fine in our
cases. A better approach is probably similar to finding a transitive closure of
hypotheses against some "potentially needed" criteria. 
<div class="paragraph"> </div>

 This pruning tactic is conservative, hence the name "safe". However, it can
still make the goal unprovable. For example, it does not consider, say, that the
set relations may appear in a conjunction. 
</div>
<div class="code">
<span class="comment">(*&nbsp;TODO:&nbsp;is&nbsp;it&nbsp;a&nbsp;way&nbsp;to&nbsp;check&nbsp;the&nbsp;conclusion&nbsp;of&nbsp;a&nbsp;hypothesis&nbsp;has&nbsp;certain&nbsp;"head"?<br/>
I&nbsp;am&nbsp;using&nbsp;<span class="inlinecode"><span class="id" title="keyword">context</span></span> <span class="inlinecode">[<span class="id" title="var">_</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">_</span>]</span>&nbsp;for&nbsp;now,&nbsp;which&nbsp;has&nbsp;some&nbsp;false&nbsp;negatives.&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">set_prune_hyps_safe</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">set_fold_not</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">T</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">T</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#7472ec14e3f8670903ae6b55a0e2f38c"><span class="id" title="notation">⊆</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#84ed560d885c4affec56d11a371728c0"><span class="id" title="notation">≡</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#c25a9c7b1a4bc0f91edca9e331dd7eee"><span class="id" title="notation">∅</span></a> =&gt; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> *; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#84ed560d885c4affec56d11a371728c0"><span class="id" title="notation">≡</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#4291a6e02d5eff431051107aaf15194c"><span class="id" title="notation">∉</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#7472ec14e3f8670903ae6b55a0e2f38c"><span class="id" title="notation">⊆</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#84ed560d885c4affec56d11a371728c0"><span class="id" title="notation">≡</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#4291a6e02d5eff431051107aaf15194c"><span class="id" title="notation">∉</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#4291a6e02d5eff431051107aaf15194c"><span class="id" title="notation">∉</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#bb8184054cdbc2cb76438a0b028fc3e8"><span class="id" title="notation">{[</span></a><span class="id" title="var">_</span><a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#bb8184054cdbc2cb76438a0b028fc3e8"><span class="id" title="notation">]}</span></a> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.sets.html#not_elem_of_singleton_1"><span class="id" title="lemma">not_elem_of_singleton_1</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Clear&nbsp;a&nbsp;subset&nbsp;relation&nbsp;if&nbsp;it&nbsp;is&nbsp;subsumed&nbsp;by&nbsp;another&nbsp;hypothesis.&nbsp;This<br/>
&nbsp;&nbsp;simple&nbsp;heuristic&nbsp;can&nbsp;result&nbsp;in&nbsp;~50x&nbsp;faster&nbsp;set&nbsp;solving&nbsp;in&nbsp;some&nbsp;cases.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">S</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#7472ec14e3f8670903ae6b55a0e2f38c"><span class="id" title="notation">⊆</span></a> ?<span class="id" title="var">U</span>, <span class="id" title="var">H'</span> : ?<span class="id" title="var">S</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#7472ec14e3f8670903ae6b55a0e2f38c"><span class="id" title="notation">⊆</span></a> ?<span class="id" title="var">V</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> <span class="id" title="var">U</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">U</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">U1</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#e8953ae2b2281f9c2fbbd0d5d6e30fd3"><span class="id" title="notation">∪</span></a> ?<span class="id" title="var">U2</span> =&gt; <span class="id" title="var">go</span> <span class="id" title="var">U1</span>; <span class="id" title="var">go</span> <span class="id" title="var">U2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">V</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">U</span>] =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span> <span class="id" title="var">go</span> <span class="id" title="var">U</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">set_hyp_filter</span></span> filters a hypothesis in continuation style, so we can
thread a few filters. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "set_hyp_filter" <span class="id" title="keyword">constr</span>(<span class="id" title="var">T</span>) "&gt;&gt;=" <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">T</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#7472ec14e3f8670903ae6b55a0e2f38c"><span class="id" title="notation">⊆</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#84ed560d885c4affec56d11a371728c0"><span class="id" title="notation">≡</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#7472ec14e3f8670903ae6b55a0e2f38c"><span class="id" title="notation">⊆</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#84ed560d885c4affec56d11a371728c0"><span class="id" title="notation">≡</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "set_hyp_filter" <span class="id" title="keyword">constr</span>(<span class="id" title="var">T</span>) <span class="id" title="keyword">constr</span>(<span class="id" title="var">x</span>) "&gt;&gt;=" <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">T</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">x</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">T</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#4291a6e02d5eff431051107aaf15194c"><span class="id" title="notation">∉</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#2a78afea1eeed082be084d2a55e1605c"><span class="id" title="notation">∈</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#4291a6e02d5eff431051107aaf15194c"><span class="id" title="notation">∉</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> <span class="id" title="var">_</span>] =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">T</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
This pruning tactic is more radical. It is more likely to destroy the
goal, but it also offers better performance in certain cases. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">set_prune_hyps</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">set_prune_hyps_safe</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <span class="id" title="var">_</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#7472ec14e3f8670903ae6b55a0e2f38c"><span class="id" title="notation">⊆</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">T</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_hyp_filter</span> <span class="id" title="var">T</span> &gt;&gt;= (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">y</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.base.html#4291a6e02d5eff431051107aaf15194c"><span class="id" title="notation">∉</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">T</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_hyp_filter</span> <span class="id" title="var">T</span> &gt;&gt;= (<span class="id" title="keyword">fun</span> <span class="id" title="var">T</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_hyp_filter</span> <span class="id" title="var">T</span> <span class="id" title="var">y</span> &gt;&gt;= (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">&lt;&gt;</span></a> ?<span class="id" title="var">y</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : ?<span class="id" title="var">T</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_hyp_filter</span> <span class="id" title="var">T</span> &gt;&gt;= (<span class="id" title="keyword">fun</span> <span class="id" title="var">T</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_hyp_filter</span> <span class="id" title="var">T</span> <span class="id" title="var">x</span> &gt;&gt;= (<span class="id" title="keyword">fun</span> <span class="id" title="var">T</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">set_hyp_filter</span> <span class="id" title="var">T</span> <span class="id" title="var">y</span> &gt;&gt;= (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "set_solver" "!" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">set_prune_hyps_safe</span>; <span class="id" title="var">set_solver</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "set_solver" "!!" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">set_prune_hyps</span>; <span class="id" title="var">set_solver</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "fast_set_solver" "!" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">set_prune_hyps_safe</span>; <span class="id" title="var">fast_set_solver</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "fast_set_solver" "!!" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">set_prune_hyps</span>; <span class="id" title="var">fast_set_solver</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "fast_set_solver" "*" "!" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">set_prune_hyps_safe</span>; <span class="id" title="var">fast_set_solver</span>*.<br/>
<span class="id" title="keyword">Tactic Notation</span> "fast_set_solver" "*" "!!" :=<br/>
&nbsp;&nbsp;<span class="id" title="var">set_prune_hyps</span>; <span class="id" title="var">fast_set_solver</span>*.<br/>

<br/>
</div>

<div class="doc">
<a id="lab7"></a><h2 class="section">Forward reasoning</h2>

<div class="paragraph"> </div>

 Duplicate hypothesis <span class="inlinecode"><span class="id" title="var">H</span></span> and continue with <span class="inlinecode"><span class="id" title="var">tac</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "dup_hyp" <span class="id" title="var">hyp</span>(<span class="id" title="var">H</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H'</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H'</span>; <span class="id" title="var">tac</span> <span class="id" title="var">H'</span>.<br/>

<br/>
</div>

<div class="doc">
Check if <span class="inlinecode"><span class="id" title="var">p</span></span> is not in the hypothesis context. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">no_hyp</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| ?<span class="id" title="var">T</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">T</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "hypothesis exists"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Add hypothesis <span class="inlinecode"><span class="id" title="var">p</span></span> if it is not in the context already. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">add_hyp</span> <span class="id" title="var">p</span> := <span class="id" title="var">no_hyp</span> <span class="id" title="var">p</span>; <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <span class="id" title="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
Check if there is another hypothesis that is the same as <span class="inlinecode"><span class="id" title="var">H</span></span>. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">exists_same_hyp</span> <span class="id" title="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| ?<span class="id" title="var">X</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H'</span> : <span class="id" title="var">X</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H'</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Check if <span class="inlinecode"><span class="id" title="var">H</span></span> is unique in the context. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">uniq_hyp</span> <span class="id" title="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tryif</span> <span class="id" title="var">exists_same_hyp</span> <span class="id" title="var">H</span> <span class="id" title="keyword">then</span> <span class="id" title="tactic">fail</span> "hypothesis is not unique" <span class="id" title="keyword">else</span> <span class="id" title="tactic">idtac</span>.<br/>

<br/>
</div>

<div class="doc">
Blocking and unblocking hypotheses. They are used as markers. 
</div>
<div class="code">
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">block_hyp</span> <span class="id" title="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| ?<span class="id" title="var">T</span> =&gt; <span class="id" title="tactic">change</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> <span class="id" title="var">T</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">unblock_hyp</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">unfold</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">unblock_hyps</span> := <span class="id" title="tactic">unfold</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> <span class="id" title="tactic">in</span> *.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">clear_blocked</span> := <span class="id" title="tactic">try</span> <span class="id" title="var">select</span>! (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> <span class="id" title="var">_</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">not_blocked_hyp</span> <span class="id" title="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">type</span> <span class="id" title="keyword">of</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">dup_hyp</span>!</span> tactics allow we to implement forward reasoning tactics a la
saturation. Currently, our saturation is naive, ad-hoc and quite fragile. It
also requires a few boilerplates.  Duplicate <span class="inlinecode"><span class="id" title="var">H</span></span> and continue with <span class="inlinecode"><span class="id" title="var">tac</span></span>. We check if <span class="inlinecode"><span class="id" title="var">tac</span></span> produces something
that is already in the context, and fail in this case to avoid divergence. This
tactic also continues with <span class="inlinecode"><span class="id" title="var">ktac</span></span> after checking, in case <span class="inlinecode"><span class="id" title="var">ktac</span></span> destroys the
hypothesis completely, e.g., by <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>. We use blocking to mark a hypothesis
has been produced before, and we need to clear the blocked hypotheses after
saturation. It would be better if we can create and access another global
context in ltac, so we can thread a few tactics together without messing with
the hypothesis context. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "dup_hyp" "!" <span class="id" title="var">hyp</span>(<span class="id" title="var">H</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) "with" <span class="id" title="var">tactic3</span>(<span class="id" title="var">ktac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dup_hyp</span> <span class="id" title="var">H</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">dup_hyp</span> <span class="id" title="var">H</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">block_hyp</span> <span class="id" title="var">H</span>; <span class="id" title="var">uniq_hyp</span> <span class="id" title="var">H</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ktac</span> <span class="id" title="var">H</span>).<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "dup_hyp" "!" <span class="id" title="var">hyp</span>(<span class="id" title="var">H</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">dup_hyp</span>! <span class="id" title="var">H</span> <span class="id" title="var">tac</span> <span class="id" title="keyword">with</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab8"></a><h2 class="section">Hypothesis application</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">curry_tac</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>?<span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> ?<span class="id" title="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">curry_tac</span> (<span class="id" title="var">f</span> <span class="id" title="var">a</span>) <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#tt"><span class="id" title="constructor">tt</span></a> =&gt; <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span> <span class="id" title="var">go</span> <span class="id" title="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">apply_eq</span></span> applies hypothesis <span class="inlinecode"><span class="id" title="var">H</span></span>, and generates equality subgoals for the
arguments if the arguments can not be unified. Note that this tactic only
generates equality subgoals from the last argument to the first argument that
can not be substituted, most likely due to dependent type. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "apply_eq" <span class="id" title="var">uconstr</span>(<span class="id" title="var">H</span>) "by" <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">go</span> <span class="id" title="var">R</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">R</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">R</span> ?<span class="id" title="var">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tryif</span> <span class="id" title="var">is_evar</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">go</span> <span class="id" title="var">R</span> <span class="id" title="keyword">constr</span>:(<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="tactic">fresh</span> "e" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">f</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="keyword">fun</span> <a id="e:1" class="idref" href="#e:1"><span class="id" title="binder">e</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">let</span> <span class="id" title="var">g</span> := <span class="id" title="var">curry_tac</span> (<span class="id" title="var">R</span> <span class="id" title="var">e</span>) <span class="id" title="var">p</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">g</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#eq_ind"><span class="id" title="definition">eq_ind</span></a> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); [| <span class="id" title="var">block_goal</span> ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" title="var">T</span> =&gt; <span class="id" title="var">go</span> <span class="id" title="var">T</span> <span class="id" title="keyword">constr</span>:(<a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Datatypes.html#tt"><span class="id" title="constructor">tt</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>; [ <span class="id" title="var">tac</span> <span class="id" title="var">H</span> | .. ];<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.tactics.html#block"><span class="id" title="definition">block</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">unblock_goal</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "apply_eq" <span class="id" title="var">uconstr</span>(<span class="id" title="var">H</span>) := <span class="id" title="var">apply_eq</span> <span class="id" title="var">H</span> <span class="id" title="tactic">by</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "eapply_eq" <span class="id" title="var">uconstr</span>(<span class="id" title="var">H</span>) := <span class="id" title="var">apply_eq</span> <span class="id" title="var">H</span> <span class="id" title="tactic">by</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">auto_apply</span></span> applies the first appliable hypothesis of the same shape. It is
useful for applying induction hypotheses automatically. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "auto_apply" "by" <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span>] |- ?<span class="id" title="var">C</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span> <span class="id" title="var">_</span>] |- ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |- ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |- ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |- ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |- ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |- ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="keyword">context</span> [<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>] |- ?<span class="id" title="var">C</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">tac</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "auto_apply" := <span class="id" title="var">auto_apply</span> <span class="id" title="tactic">by</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "auto_eapply" := <span class="id" title="var">auto_apply</span> <span class="id" title="tactic">by</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "auto_apply_eq" := <span class="id" title="var">auto_apply</span> <span class="id" title="tactic">by</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">apply_eq</span> <span class="id" title="var">H</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "auto_eapply_eq" := <span class="id" title="var">auto_apply</span> <span class="id" title="tactic">by</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">eapply_eq</span> <span class="id" title="var">H</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab9"></a><h2 class="section">General solvers</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Tactic Notation</span> "equiv_naive_solver" "by" <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">solve</span> [ <span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">symmetry</span>; <span class="id" title="var">tac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">etrans</span>; <span class="id" title="tactic">solve</span> [<span class="id" title="var">tac</span> | <span class="id" title="tactic">symmetry</span>; <span class="id" title="var">tac</span>] ].<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">equiv_naive_solver</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">equiv_naive_solver</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eauto</span>.<br/>

<br/>
<span class="comment">(*&nbsp;These&nbsp;two&nbsp;tactics&nbsp;are&nbsp;taken&nbsp;from&nbsp;the&nbsp;development&nbsp;version&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="var">stdpp</span></span>.&nbsp;Remove<br/>
them&nbsp;when&nbsp;they&nbsp;release&nbsp;it.&nbsp;*)</span><br/>
<span class="id" title="keyword">Tactic Notation</span> "compute_done" :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp/stdpp.decidable.html#bool_decide_unpack"><span class="id" title="lemma">bool_decide_unpack</span></a> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="keyword">vm_compute</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">first</span> [ <span class="id" title="tactic">exact</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#I"><span class="id" title="constructor">I</span></a> | <span class="id" title="tactic">exact</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.13.2/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> ].<br/>
<span class="id" title="keyword">Tactic Notation</span> "compute_by" <span class="id" title="var">tactic</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">tac</span>; <span class="id" title="var">compute_done</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
